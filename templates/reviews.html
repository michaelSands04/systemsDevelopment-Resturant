{% extends "base.html" %}
{% block content %}
<h1 class="mb-3">Reviews</h1>
<p class="text-muted">This page uses Firestore as the second database (NoSQL).</p>

<div class="card mb-4">
  <div class="card-body">
    <h5 class="card-title">Leave a review</h5>

    {% if user %}
      <form method="post">
        <div class="mb-3">
          <label class="form-label">Rating (1â€“5)</label>
          <select class="form-select" name="rating">
            <option value="5" selected>5</option>
            <option value="4">4</option>
            <option value="3">3</option>
            <option value="2">2</option>
            <option value="1">1</option>
          </select>
        </div>

        <div class="mb-3">
          <label class="form-label">Comment</label>
          <textarea class="form-control" name="comment" rows="3" required></textarea>
        </div>

        <button class="btn btn-success" type="submit">Submit review</button>
      </form>
    {% else %}
      <div class="alert alert-warning mb-0">
        Please <a href="/login">log in</a> to leave a review.
      </div>
    {% endif %}
  </div>
</div>

<h5 class="mb-3">Latest reviews</h5>

{% if reviews and reviews|length > 0 %}
  <div class="list-group">
    {% for r in reviews %}
      <div class="list-group-item">
        <div class="d-flex justify-content-between">
          <strong>{{ r.username or "anonymous" }}</strong>
          <span>{{ r.rating }}/5</span>
        </div>
        <div class="mt-2">{{ r.comment }}</div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>No reviews yet.</p>
{% endif %}

{% endblock %}
